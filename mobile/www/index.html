<!DOCTYPE html>
<style>



body {
    font-size:12px;
    margin:0px;
    padding:0px;
    overflow:hidden;
    font-family:'lato';
    font-weight:300;
}




div.statusbar{
  position:fixed;
  top:0px;
  left:0px;
  height:20px;
  width:100%;
  background:rgb(255,255,255);
}



div.app{
  position:fixed;
  top:20px;
  left:0px;
  width:100%;
  bottom:0px;
  background:rgb(240,240,240);
}


div.swipeFrame{
  height:100%;
  width:auto;
  overflow:hidden;
}
div.swipeFrame div.swipe-wrap{
  height:100%;
}
div.pane{
  width:100%;
  height:100%;
  overflow-x:hidden;
  overflow-y:scroll;
  background:rgb(240,240,240);
  position:relative;
  float:left;
  display:none;
}






div.signup{
  position:absolute;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
  overflow:hidden;
  background:rgb(255,255,255);
  z-index:2;
}
div.signup.complete{
  display:none;
}
div.signup div.form{
  position:absolute;
  bottom:0px;
  left:0px;
  width:100%;
}
div.signup div.button{
  padding:18px 0px 26px 0px;
  font-size:15px;
  color:rgb(160,160,160);
  text-align:center;
  border-top:1px solid rgb(230,230,230);
  height:20px;
  line-height:20px;
}
div.signup div.button img{
  display:none;
}
div.signup div.button.loading img{
  display:inline;
}
div.signup div.button.loading label{
  display:none;
}
div.signup input[type='text'],
div.signup input[type='password'],
div.signup input[type='email']{
  padding:11px 9px;
  border:none;
  outline:none;
  border-top:1px solid rgb(230,230,230);
  width:100%;
  box-shadow:none;
  -webkit-border-radius: 0px;
  -moz-border-radius:    0px;
  border-radius:         0px;
  font-size:15px;
  -webkit-appearance: none;
}
div.signup div.logo{
  position:absolute;
  top:0px;
  left:0px;
  right:0px;
  bottom:243px;
}
div.signup div.logo div.image{
  position:absolute;
  width:90px;
  height:90px;
  background:url('images/logo.png') no-repeat;
  background-size:90px 90px;
  top:50%;
  left:50%;
  margin:-57px 0px 0px -45px;
}
div.signup div.logo div.text{
  text-align:center;
  color:rgb(160,160,160);
  font-size:21px;
  width:100%;
  left:0px;
  top:50%;
  margin-top:53px;
  position:absolute;
  font-family:'secretcode';
}






div.pane.self{
  overflow:hidden;
}




div.header{
  height:52px;
  line-height:52px;
  box-shadow:0px 1px 3px rgb(240,240,240);
  border-bottom:1px solid rgb(240,240,240);
  z-index:1;
  background:rgba(255,255,255,0.95);
  font-family:'secretcode';
}
div.header div.text{
  position:absolute;
  left:74px;
  right:74px;
  text-align:center;
  color:rgb(100,100,100);
  font-size:21px;
}
div.header div.lbutton{
  float:left;
  height:40px;
  width:40px;
  margin:6px;
  background:url(images/settings.png) no-repeat;
  background-size:40px 40px;
  margin-left: 22px;
}
div.header div.rbutton{
  float:right;
  height:40px;
  width:40px;
  margin:6px;
  background:url(images/plus.png) no-repeat;
  background-size:40px 40px;
  margin-right: 22px;
}





.scrollable{
  -webkit-overflow-scrolling: touch;
}




div.gifts{
  z-index:-1;
  position:absolute;
  top:0px;
  left:0px;
  right:0px;
  bottom:0px;
  overflow-x:hidden;
  overflow-y:scroll;
  padding:2px 8px;
}
div.gifts div.filler{
  height:52px;
}
div.gifts div.gift{
  margin:12px 0px;
  background:rgb(255,255,255);
  height:68px;
  position:relative;
}
div.gifts div.gift div.image{
  height:40px;
  width:40px;
  margin:14px;
  background-size:40px 40px;
  float:left;
  position:relative;
  background-image:url(images/read.png);
  background-repeat:no-repeat;
}
div.gifts div.gift.notviewable div.image{
  background-image:url(images/notviewable.png);
}
div.gifts div.gift.viewable div.image{
  background-image:url(images/viewable.png);
}
div.gifts div.gift.sent div.image:after{
  content:'';
  position:absolute;
  top:0px;
  left:0px;
  width:40px;
  height:40px;
  background:url(images/sent_skin.png) no-repeat;
  background-size:40px 40px;
}

div.gifts div.gift div.text{
  position:absolute;
  left:68px;
  right:0px;
  top:0px;
  padding:13px 0px;
  font-size:11px;
  color:rgb(142,142,142);
  overflow:hidden;
  white-space:nowrap;
}
div.gifts div.gift div.text div.title{
  font-size:15px;
  color:rgb(0,0,0);
  margin:3px 0px;
}










div.app.signedin div.pane{
  display:block;
}
div.pane.initial{
  display:block;
}






div.buttonshaker{
  position:absolute;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
}









div.settings{
  background:rgb(255,255,255);
}
div.settings div.picture img{
  -webkit-border-radius: 50%;
  -moz-border-radius:    50%;
  border-radius:         50%;
  width:110px;
  height:110px;
  display:block;
  margin:40px auto 30px auto;
}
div.settings div.picture div{
  text-align:center;
  margin-top:20px;
  font-size:15px;
  margin-bottom:40px;
}
div.settings div.bar{
  height:1px;
  background:rgb(230,230,230);
}
div.settings div.item{
  color:rgb(135,135,135);
  padding:14px 20px;
  font-size:16px;
  background:rgb(255,255,255);
  border-bottom:1px solid rgb(230,230,230);
  line-height:20px;
}
div.settings div.item *{
  vertical-align:middle;
}
div.settings div.item img{
  height:29px;
  margin-right:20px;
}
div.settings div.filler{
  height:23px;
}







div.capture div.buttons{
  position:absolute;
  bottom:0px;
  left:0px;
  height:227px;
  width:100%;
  background:rgb(255,255,255);
}
div.capture div.buttonframe{
  width:100px;
  height:100px;
  -webkit-border-radius: 50%;
  -moz-border-radius:    50%;
  border-radius:         50%;
  border:1px solid rgb(240,240,240);
  margin:-50px 0px 0px -50px;
  position:absolute;
  top:50%;
  left:50%;
}
div.capture div.buttonframe div.button{
  background:rgb(240,240,240);
  -webkit-border-radius: 50%;
  -moz-border-radius:    50%;
  border-radius:         50%;
  margin:0px;
  width:100px;
  height:100px;
}
div.capture div.check{
  position:absolute;
  left:50%;
  margin-left:90px;
  height:30px;
  width:30px;
  background:green;
  margin-top:-15px;
  top:50%;
  -webkit-border-radius: 50%;
  -moz-border-radius:    50%;
  border-radius:         50%;
}
div.capture div.cancel{
  position:absolute;
  right:50%;
  margin-right:90px;
  height:30px;
  width:30px;
  background:red;
  margin-top:-15px;
  top:50%;
  -webkit-border-radius: 50%;
  -moz-border-radius:    50%;
  border-radius:         50%;
}

div.capture div.image{
  position:absolute;
  top:0px;
  bottom:227px;
  left:0px;
  width:100%;
}
div.capture div.image img{
  position:absolute;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
}



div.capture div.options{
  position:absolute;
  top:100%;
  left:0px;
  width:100%;
  height:100%;
}
div.capture div.options div.frame{
  position:absolute;
  top:10px;
  left:10px;
  right:10px;
  bottom:10px;
  height:auto;
  box-shadow:0px 0px 10px rgba(0,0,0,0.5);
  -webkit-border-radius: 3px;
  -moz-border-radius:    3px;
  border-radius:         3px;
  background:rgb(255,255,255);
  overflow-x:hidden;
  overflow-y:scroll;
}


</style>
<html>
<head>
<meta charset="utf-8" />
<meta name="format-detection" content="telephone=no" />
<meta name="msapplication-tap-highlight" content="no" />
<!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
<title>Sealed</title>
<link rel="stylesheet" type="text/css" href="resources/CSS/resets.css"></link>
<link rel='stylesheet' href='resources/CSS/lato.css'/></link>
<link rel='stylesheet' href='resources/CSS/secretcode.css'/></link>
<script src='resources/Scripts/swipe.js'></script>
<script src='resources/Scripts/Request.js'></script>
<script src='resources/Scripts/fastclick.js'></script>
<script src='resources/Scripts/Transition.js'></script>
<script type="text/javascript" src="cordova.js"></script>
</head>
<body>



<div class='statusbar'></div>
  

<div class='app'>
  <div id='appbody' class='swipe swipeFrame'>
    <div class='swipe-wrap'>
      
      
      <div class='pane settings scrollable'>
        <div class='picture'>
          <img src='https://avatars3.githubusercontent.com/u/2695807?s=460'/>
          <div>Hunter Larco</div>
        </div>
        <div class='bar'></div>
        <div class='item'><img src='images/gear.png'/><label>app settings</label></div>
        <div class='item'><img src='images/question.png'/><label>support</label></div>
        <div class='item'><img src='images/mail.png'/><label>contact meantime</label></div>
        <div class='item'><img src='images/share.png'/><label>share meantime</label></div>
        <div class='item'><img src='images/arrow.png'/><label>logout</label></div>
        <div class='filler'></div>
      </div>
      
      
      <div class='pane self initial'>
        <div class='buttonshaker' id='buttonshaker'>
          <div class='header'>
            <div class='lbutton' id='settingsbutton'></div>
            <div class='rbutton' id='plusbutton'></div>
            <div class='text'>sealed</div>
          </div>
          <div class='headerbackground'></div>
          <div class='gifts scrollable'>
            <div class='filler'></div>
            <div class='gift notviewable sent'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Laney Larco</div>
                <div class='data'>sent 2 hours ago - viewed - viewable now</div>
              </div>
            </div>
            <div class='gift notviewable'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Prince Leah</div>
                <div class='data'>recieved 4 hours ago - viewable today at 6:30p</div>
              </div>
            </div>
            <div class='gift viewable'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Richard Branson</div>
                <div class='data'>sent 2 days ago - viewable in 4 days at 11p</div>
              </div>
            </div>
            <div class='gift viewable'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Laney Larco</div>
                <div class='data'>sent 2 hours ago - viewed - viewable now</div>
              </div>
            </div>
            <div class='gift viewable sent'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Prince Leah</div>
                <div class='data'>recieved 4 hours ago - viewable today at 6:30p</div>
              </div>
            </div>
            <div class='gift'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Richard Branson</div>
                <div class='data'>sent 2 days ago - viewable in 4 days at 11p</div>
              </div>
            </div>
            <div class='gift'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Laney Larco</div>
                <div class='data'>sent 2 hours ago - viewed - viewable now</div>
              </div>
            </div>
            <div class='gift'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Prince Leah</div>
                <div class='data'>recieved 4 hours ago - viewable today at 6:30p</div>
              </div>
            </div>
            <div class='gift'>
              <div class='image'></div>
              <div class='text'>
                <div class='title'>Richard Branson</div>
                <div class='data'>sent 2 days ago - viewable in 4 days at 11p</div>
              </div>
            </div>
          </div>
          <div class='signup' id='signup_form'>
            <div class='logo'>
              <div class='image'></div>
              <div class='text'>sealed</div>
            </div>
            <div class='form'>
              <input type='text' placeholder='first name'/>
              <input type='text' placeholder='last name'/>
              <input type='email' id='signupemail' placeholder='email address'/>
              <input type='password' id='signuppassword' placeholder='password'/>
              <div class='button' id='signupbutton'><label>sign up</label><img src='images/loading.gif'/></div>
            </div>
          </div>
        </div>
      </div>
    
       
      <div class='pane capture'>
        <div class='image'>
          <img src='http://img1.cookinglight.timeinc.net/sites/default/files/image/2005/05/0505p116-white-birthday-cake-l.jpg'/>
        </div>
        <div class='buttons'>
          <div class='check' id='imagecheck'></div>
          <div class='cancel' id='imagecancel'></div>
          <div class='buttonframe'>
            <div class='button' id='recordbutton'></div>
          </div>
        </div>
        
        <div class='options' id='optionspane'>
          <div class='frame'></div>
        </div>
      </div>
    
    
    </div>
  </div>
</div>





<script type='text/javascript'>


var app = {
  gateway: 'http://192.168.1.19:8092/api/',
  alert: function(message, title){
    if (!!navigator.notification)
      navigator.notification.alert(message, null, title, 'OK');
    else
      alert(title ? (title + ": " + message) : message);
  },
  loadElement: function(id){
    var elem = document.getElementById(id);
    elem.removeAttribute('id');
    return elem;
  },
  setupLibraries: function(){
    FastClick.attach(document.body);
    Request.loadGateway(app.gateway);
  },
  loadElements: function(){
    var elements = [
      'signupemail',
      'signuppassword',
      'signupbutton',
      'settingsbutton',
      'plusbutton',
      'buttonshaker',
      'recordbutton',
      'imagecheck',
      'imagecancel',
      'optionspane'
    ];
    for(var i,variable; variable=elements[i++];)
      window[variable] = app.loadElement(variable);
  }
}
















var SignupForm = new (function(){
  var self = this;
  
  var working = false;
  
  self.submit = Submit;
  
  function Stop(){
    signupbutton.setAttribute('class', 'button');
    working = false;
  }
  
  function OnSuccess(event){
    InitSwipePanes();
    FadeSignup();
  }
  
  function OnError(event){
    if(event.code == 200)
      app.alert('Your email address is already in use')
    else
      app.alert("We're sorry, an unexpected error occured. Please Try Again", "Oh No!");
    Stop();
  }
  
  function Send(event){
    /*
    setTimeout(OnSuccess, 500);
    return;
    */
    if(signupemail.value.length == 0 || signuppassword.value.length == 0){
       app.alert('Please fill out all fields', 'Oh No!');
       Stop();
       return;
     }
    var request = new Request('user/signup');
    request.post({
      'email': signupemail.value,
      'password': signuppassword.value
    }, OnSuccess, OnError);
  }
  
  function Submit(){
    if(working) return;
    working = true;
    signupbutton.setAttribute('class', 'button loading');
    Send();
  }
  
})();

















function InitSwipePanes(){
  var appbody = app.loadElement('appbody');
  appbody.parentElement.setAttribute('class', 'app signedin');
  window.swipeObject = Swipe(appbody, {
    continuous: false,
    startSlide: 1,
    callback: function(index, element) {}
    // disableScroll: true
    // stopPropagation: true,
    // transitionEnd: function(index, element) {}
  });
}



function FadeSignup(){
  var signup_form = app.loadElement('signup_form')
  Transition.EaseInOut(250, function(percent){
    signup_form.style.opacity = 1-percent;
  }, function(){
    signup_form.style.display = 'none';
  });
}



















function OnDeviceReady(){
  // -------------- load libraries and important HTML elements -------------- //
  app.setupLibraries();
  app.loadElements();
  
  
  if(Request.hasSession()){
    signup_form.style.display = 'none';
    InitSwipePanes();
  }
  
  
  // -------------- bind html buttons -------------- //
  signupbutton.addEventListener('click', SignupForm.submit);

  settingsbutton.addEventListener('click', function(){
    Transition.Bounce(500, function(percent){
      buttonshaker.style.left = Math.round(10*percent*34)/10+'px';
    });
  });

  plusbutton.addEventListener('click', function(){
    Transition.Bounce(500, function(percent){
      buttonshaker.style.left = -Math.round(10*percent*34)/10+'px';
    });
  });
  
  
  
  
  
  
  
  
  
  function CameraSuccess(mediaFiles){
    var i, len;
    for (i = 0, len = mediaFiles.length; i < len; i += 1)
      uploadFile(mediaFiles[i]);
  }
  function CameraError(){
    app.alert('An error occured during capture');
  }
  function uploadFile(mediaFile){
    
    function RecievedUploadURL(event){
      var ft = new FileTransfer(),
          path = mediaFile.fullPath,
          name = mediaFile.name;
      ft.upload(path,
        event.url,
        function(event) {
          app.alert('success')
          console.log('Upload success: ' + result.responseCode);
          console.log(result.bytesSent + ' bytes sent');
        },
        function(event) {
          app.alert('error')
          console.log('Error uploading file ' + path + ': ' + error.code);
        },
        {
          fileName: name,
          params: {
            'uid': Request.getUID()
          }
        }
      );  
    }
    function URLError(event){
      app.alert(event.message, 'Oh Uh!');
    }
    
    var request = new Request('upload/geturl')
    request.post({}, RecievedUploadURL, URLError); 
  }
  
  
  
  
  
  
  
  
  
  
  
  
  var running = false, firstTime = true;
  recordbutton.parentElement.addEventListener('click', function(){
    if(firstTime){
      Transition.EaseInOut(300, function(percent){
        recordbutton.style.margin = percent*30+'px';
        recordbutton.style.width = recordbutton.style.height = (100-percent*60)+'px';
      }, function(){
        navigator.device.capture.captureVideo(CameraSuccess, CameraError, {limit:1});
      });
      firstTime = false;
    }else if(running){
      Transition.EaseInOut(300, function(percent){
        recordbutton.style.margin = (30-percent*25)+'px';
        recordbutton.style.width = recordbutton.style.height = (40+percent*50)+'px';
      });
    }else if(!running){
      Transition.EaseInOut(300, function(percent){
        recordbutton.style.margin = (5+percent*25)+'px';
        recordbutton.style.width = recordbutton.style.height = (90-percent*50)+'px';
      });
    }
    running = !running;
  });
  
  imagecheck.addEventListener('click', function(){
    Transition.EaseInOut(300, function(percent){
      optionspane.style.top = (1-percent)*100+'%';
    });
  });
  
}












// phone
document.addEventListener('deviceready', OnDeviceReady, false);
// computer (development assisting functions)
window.onload = OnDeviceReady;
document.addEventListener('keyup', function(event){
  if(!window.swipeObject) return;
  if(event.keyCode == 39)
    swipeObject.next();
  else if(event.keyCode == 37)
    swipeObject.prev();
}, false);
</script>
</body>
</html>
