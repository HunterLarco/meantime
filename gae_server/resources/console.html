<!DOCTYPE>
<html>
<head>
<style type='text/css'>

body{
  padding:0px;
  margin:0px;
  font-family:arial;
  font-size:15px;
}


div.memory{
  background:rgb(240,240,240);
  display:inline-block;
  float:left;
  width:40%;
  height:100%;
}

div.request{
  display:inline-block;
  float:left;
  width:60%;
  height:100%;
  box-shadow:0px 0px 15px rgba(0,0,0,0.6);
  overflow:scroll;
}

div.title{
  padding:16px 0px;
  text-align:center;
  font-size:18px;
  background:rgb(203,78,78);
  color:rgb(255,255,255);
  border-bottom:1px solid rgb(153,28,28);
}

div.table{
  margin-top:8px;
}
div.table div.mem div.line:nth-child(odd){
  background:rgb(255,255,255);
}
div.table div.header{
  font-weight:bold;
  margin-bottom:4px;
}
div.table div.line{
  white-space:nowrap;
  padding:4px 0px;
}
div.table div.line div{
  display:inline-block;
  text-align:center;
}
div.table div.line div.key{
  width:30%;
}
div.table div.line div.value{
  width:70%;
}


div.request div.tag{
  font-size:13px;
  background:rgb(240,240,240);
  padding:4px 0px;
  text-align:center;
  margin-bottom:8px;
}

div.request div.authtoken{
  padding:6px 18px;
}
div.request div.url{
  padding:6px 18px;
}
input{
  min-width:300px;
  padding:5px 7px;
  border:1px solid #4285f4;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
}
div.request div.authtoken input{
  width:100%;
}
div.button{
  display:inline-block;
  position:relative;
  padding:4px 7px;
  border:none;
  border-bottom:3px solid rgb(66,133,244);
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  background:rgb(96,163,255);
  color:rgb(255,255,255);
  outline:none;
  cursor:pointer;
  text-align:center;
}
div.button:hover{
  border-bottom:2px solid rgb(66,133,244);
  border-top:1px solid rgb(255,255,255);
}
div.button:active{
  border-bottom:1px solid rgb(66,133,244);
  border-top:2px solid rgb(255,255,255);
}
div.request div.spacer{
  width:20px;
  height:1px;
  display:inline-block;
}

div.request div.response{
  border-top:4px solid rgb(203,78,78);
  box-shadow:inset 0px 1px 0px rgb(153,28,28);
  margin-top:16px;
  padding-top:1px;
}


div.request div.data{
  margin:20px;
  padding:10px;
  border:1px solid rgb(102,102,102);
}
div.request div.data textarea{
  border:none;
  outline:none;
  width:100%;
  max-width:100%;
  min-height:120px;
}
div.button.send{
  margin:0px 20px;
  display:block;
}

div.response div.frame{
  padding:20px;
}
div.response div.frame label.s{
  color:green;
}
div.response div.frame label.n{
  color:red;
}
div.response div.frame label.b{
  color:rgb(255, 140, 0);
}
div.response div.frame label.nl{
  color:rgb(0, 78, 208);
}
div.response div.frame label.o{
  color:rgb(180,180,180);
}

div.request div.label{
  position:relative;
}
div.request div.label:after{
  content:'LABEL';
  position:absolute;
  right:0px;
  top:0px;
  font-size:14px;
  padding:7px;
  color:rgb(200,200,200);
}
div.request div.label.UID:after{
  content:'UID';
}
div.request div.label.ULID:after{
  content:'ULID';
}
div.request div.label.SID:after{
  content:'SID';
}


.console{
  font-family: droid sans mono,monospace,courier new,courier,sans-serif;
  font-size:14px;
  color:#1A1A1A;
  line-height:22px;
}

</style>
<meta charset='UTF-8' NAME='Author' CONTENT='Hunter Larco' />
<title>Development Console</title>
<script src='/resources/Request.js'></script>
</head>
<body>


<div class='memory panel'>
  <div class='title'>Memory</div>
  <div class='table'>
    <div class='line header'>
      <div class='key'>Key</div>
      <div class='value'>Value</div>
    </div>
    <div class='mem' id='mem'>
      <div class='line'>
        <div class='key'>Key</div>
        <div class='value'>Value</div>
      </div>
      <div class='line'>
        <div class='key'>Key</div>
        <div class='value'>Value</div>
      </div>
      <div class='line'>
        <div class='key'>Key</div>
        <div class='value'>Value</div>
      </div>
    </div>
  </div>
</div>
<div class='request panel'>
  <div class='title'>Request Panel</div>
  <div>
    <div class='tag'>Request</div>
    <div class='authtoken'>
      <div class='label UID'><input type='text' disabled id='uid'/></div>
      <div class='label ULID'><input type='text' disabled id='ulid'/></div>
      <div class='label SID'><input type='text' disabled id='sid'/></div>
    </div>
    <div class='url'>
      /api/ <input type='text' id='url' placeholder='url'/>
      <div class='spacer'></div>
      GET <input type='radio' name='method' value='get'/>
      POST <input type='radio' name='method' value='post' checked/>
    </div>
    <div class='data'><textarea id='data' class='console'></textarea></div>
    <div class='button send' id='send'>Send</div>
  </div>
  <div class='response'>
    <div class='tag' id='tag'>Response</div>
    <div id='responsetext' class='frame console'>No Responses Yet</div>
  </div>
</div>


<script type='text/javascript'>


window.onload = function(){
  
  var sendData = {};
  
  var responseframe = document.getElementById('responsetext');
  responseframe.removeAttribute('id');
  
  var sidtoken = document.getElementById('sid');
  sidtoken.removeAttribute('id');
  
  var uidtoken = document.getElementById('uid');
  uidtoken.removeAttribute('id');
  
  var ulidtoken = document.getElementById('ulid');
  ulidtoken.removeAttribute('id');
  
  var url = document.getElementById('url');
  url.removeAttribute('id');
  
  var tag = document.getElementById('tag');
  tag.removeAttribute('id');
  
  var data = document.getElementById('data');
  data.removeAttribute('id');
  data.addEventListener('keyup', BuildData)
  
  var send = document.getElementById('send');
  send.removeAttribute('id');
  
  function getMethod(){
    var elems = document.getElementsByName('method');
    for(var i=0, elem; elem=elems[i++];)
      if(elem.checked)
        return elem.value
  }
  
  function BuildData(event){
    var lines = data.value.split('\n'),
        json = {};
    for(var i=0,line; line=lines[i++];){
      var linedata = line.match(/^([^\s]*)\s+(bool|string|object|array|number|null)/);
      if(!linedata) continue;
      key = linedata[1];
      type = linedata[2];
      var linecontent;
      switch(type){
        case 'string':
          var rest = line.match(/^[^\s]*\s+string\s+(.+)/);
          if(!rest) continue;
          rest = rest[1];
          json[key] = rest;
        break;
        case 'bool':
          var bool = line.match(/^[^\s]*\s+bool\s+(true|false)/);
          if(!bool) continue;
          bool = bool[1];
          json[key] = bool=='true';
        break;
        case 'object':
          // TODO
        break;
        case 'array':
          // TODO
        break;
        case 'number':
          var number = line.match(/^[^\s]*\s+number\s+([0-9]+\.[0-9]*|[0-9]*\.[0-9]+|[0-9]+)/);
          if(!number) continue;
          number = number[1];
          json[key] = parseFloat(number);
        break;
        case 'null':
          json[key] = null;
        break;
      }
    }
    tag.innerHTML = 'JSON Package';
    PrettyPrint(json);
    sendData = json;
  }
  
  function CheckSession(data){
    if(!data['setsession']) return;
    sidtoken.value =  data['session']['sid'];
    ulidtoken.value = data['session']['ulid'];
    uidtoken.value =  data['session']['uid'];
  }
  
  function PrettyPrint(data){
    CheckSession(data);
    var singletab = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
    function recurse(object, tabs){
      for(key in object){
        if(object[key] == null){
          responseframe.innerHTML += tabs+key+' : \<label class="nl">null\</label>\<br/>';
          continue;
        }
        switch(object[key].constructor){
          case String:
            responseframe.innerHTML += tabs+key+' : \<label class="s">'+object[key]+'\</label>\<br/>';
          break;
          case Array:
            responseframe.innerHTML += tabs+key+' : \<label class="o"> Array ['+object[key].length+']\</label>\<br/>';
            recurse(object[key], tabs+singletab)
          break;
          case Number:
            responseframe.innerHTML += tabs+key+' : \<label class="n">'+object[key]+'\</label>\<br/>';
          break;
          case Boolean:
            responseframe.innerHTML += tabs+key+' : \<label class="b">'+object[key]+'\</label>\<br/>';
          break;
          case Object:
            responseframe.innerHTML += tabs+key+' : \<label class="o"> Object {'+Object.keys(object[key]).length+'}\</label>\<br/>';
            recurse(object[key], tabs+singletab)
          break;
        }
      }
    }
    responseframe.innerHTML = '{\<br/>';
    recurse(data, singletab)
    responseframe.innerHTML += '}'
  }
  
  
  
  
  
  
  
  
  
  
  
  send.addEventListener('click', function(){
    var request = new Request('/api/'+url.value);
    
    if(!!sidtoken.value)  pack['sid'] = sidtoken.value;
    if(!!uidtoken.value)  pack['uid'] = uidtoken.value;
    if(!!ulidtoken.value) pack['ulid'] = ulidtoken.value;
    
    tag.innerHTML = 'Response';
    
    if(getMethod() == 'post')
      request.post(sendData, PrettyPrint);
    else
      request.get(PrettyPrint)
  });
  
}


</script>
</body>
</html>
